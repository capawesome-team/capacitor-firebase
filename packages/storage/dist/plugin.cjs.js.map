{"version":3,"file":"plugin.cjs.js","sources":["esm/index.js","esm/web.js"],"sourcesContent":["import { registerPlugin } from '@capacitor/core';\nconst FirebaseStorage = registerPlugin('FirebaseStorage', {\n    web: () => import('./web').then(m => new m.FirebaseStorageWeb()),\n});\nexport * from './definitions';\nexport { FirebaseStorage };\n//# sourceMappingURL=index.js.map","import { WebPlugin } from '@capacitor/core';\nimport { connectStorageEmulator, deleteObject, getDownloadURL, getMetadata, getStorage, list, ref, updateMetadata, uploadBytesResumable, } from 'firebase/storage';\nexport class FirebaseStorageWeb extends WebPlugin {\n    async deleteFile(options) {\n        const storage = getStorage();\n        const storageRef = ref(storage, options.path);\n        await deleteObject(storageRef);\n    }\n    async getDownloadUrl(options) {\n        const storage = getStorage();\n        const storageRef = ref(storage, options.path);\n        const downloadUrl = await getDownloadURL(storageRef);\n        return { downloadUrl };\n    }\n    async getMetadata(options) {\n        const storage = getStorage();\n        const storageRef = ref(storage, options.path);\n        const metadata = await getMetadata(storageRef);\n        const result = {\n            bucket: metadata.bucket,\n            createdAt: new Date(metadata.timeCreated).getTime(),\n            generation: metadata.generation,\n            metadataGeneration: metadata.metageneration,\n            name: metadata.name,\n            path: metadata.fullPath,\n            size: metadata.size,\n            updatedAt: new Date(metadata.updated).getTime(),\n            cacheControl: metadata.cacheControl,\n            contentDisposition: metadata.contentDisposition,\n            contentEncoding: metadata.contentEncoding,\n            contentLanguage: metadata.contentLanguage,\n            contentType: metadata.contentType,\n            customMetadata: metadata.customMetadata,\n        };\n        if (metadata.md5Hash) {\n            result.md5Hash = metadata.md5Hash;\n        }\n        return result;\n    }\n    async listFiles(options) {\n        const storage = getStorage();\n        const storageRef = ref(storage, options.path);\n        const listOptions = {\n            maxResults: options.maxResults,\n            pageToken: options.pageToken,\n        };\n        const listResult = await list(storageRef, listOptions);\n        const result = {\n            items: listResult.items.map(item => ({\n                bucket: item.bucket,\n                name: item.name,\n                path: item.fullPath,\n            })),\n        };\n        if (listResult.nextPageToken) {\n            result.nextPageToken = listResult.nextPageToken;\n        }\n        return result;\n    }\n    async updateMetadata(options) {\n        const storage = getStorage();\n        const storageRef = ref(storage, options.path);\n        const metadata = {\n            cacheControl: options.metadata.cacheControl,\n            contentDisposition: options.metadata.contentDisposition,\n            contentEncoding: options.metadata.contentEncoding,\n            contentLanguage: options.metadata.contentLanguage,\n            contentType: options.metadata.contentType,\n            customMetadata: options.metadata.customMetadata,\n        };\n        await updateMetadata(storageRef, metadata);\n    }\n    async uploadFile(options, callback) {\n        if (!options.blob) {\n            throw new Error(FirebaseStorageWeb.ERROR_BLOB_MISSING);\n        }\n        const storage = getStorage();\n        const storageRef = ref(storage, options.path);\n        let metadata;\n        if (options.metadata) {\n            metadata = {\n                cacheControl: options.metadata.cacheControl,\n                contentDisposition: options.metadata.contentDisposition,\n                contentEncoding: options.metadata.contentEncoding,\n                contentLanguage: options.metadata.contentLanguage,\n                contentType: options.metadata.contentType,\n                md5Hash: options.metadata.md5Hash,\n                customMetadata: options.metadata.customMetadata,\n            };\n        }\n        const uploadTask = uploadBytesResumable(storageRef, options.blob, metadata);\n        uploadTask.on('state_changed', {\n            next: snapshot => {\n                const result = this.createUploadFileCallbackEvent(snapshot);\n                callback(result, undefined);\n            },\n            error: error => {\n                callback(null, error);\n            },\n            complete: () => {\n                const result = this.createUploadFileCallbackEvent(uploadTask.snapshot);\n                callback(result, undefined);\n            },\n        });\n        return Date.now().toString();\n    }\n    async useEmulator(options) {\n        const storage = getStorage();\n        const port = options.port || 9199;\n        connectStorageEmulator(storage, options.host, port);\n    }\n    createUploadFileCallbackEvent(snapshot) {\n        const result = {\n            progress: snapshot.bytesTransferred / snapshot.totalBytes,\n            bytesTransferred: snapshot.bytesTransferred,\n            totalBytes: snapshot.totalBytes,\n            completed: snapshot.state === 'success',\n        };\n        return result;\n    }\n}\nFirebaseStorageWeb.ERROR_BLOB_MISSING = 'blob must be provided.';\n//# sourceMappingURL=web.js.map"],"names":["registerPlugin","WebPlugin","storage","getStorage","ref","deleteObject","getDownloadURL","getMetadata","list","updateMetadata","uploadBytesResumable","connectStorageEmulator"],"mappings":"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"}