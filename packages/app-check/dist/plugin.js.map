{"version":3,"file":"plugin.js","sources":["esm/index.js","esm/web.js"],"sourcesContent":["import { registerPlugin } from '@capacitor/core';\nconst FirebaseAppCheck = registerPlugin('FirebaseAppCheck', {\n    web: () => import('./web').then(m => new m.FirebaseAppCheckWeb()),\n});\nexport * from './definitions';\nexport { FirebaseAppCheck };\n//# sourceMappingURL=index.js.map","import { WebPlugin } from '@capacitor/core';\nimport { getApp } from 'firebase/app';\nimport { getToken, initializeAppCheck, onTokenChanged, setTokenAutoRefreshEnabled, } from 'firebase/app-check';\nexport class FirebaseAppCheckWeb extends WebPlugin {\n    get appCheckInstance() {\n        return this._appCheckInstance;\n    }\n    set appCheckInstance(value) {\n        this._appCheckInstance = value;\n        if (value) {\n            this.registerOnTokenChangedListener();\n        }\n        else {\n            this.unregisterOnTokenChangedListener();\n        }\n    }\n    async getToken(options) {\n        if (!this.appCheckInstance) {\n            throw new Error(FirebaseAppCheckWeb.errorNotInitialized);\n        }\n        const result = await getToken(this.appCheckInstance, options === null || options === void 0 ? void 0 : options.forceRefresh);\n        return {\n            token: result.token,\n        };\n    }\n    async initialize(options) {\n        if (options === null || options === void 0 ? void 0 : options.debugToken) {\n            self.FIREBASE_APPCHECK_DEBUG_TOKEN = options.debugToken;\n        }\n        else if (options === null || options === void 0 ? void 0 : options.debug) {\n            self.FIREBASE_APPCHECK_DEBUG_TOKEN = true;\n        }\n        let provider = options === null || options === void 0 ? void 0 : options.provider;\n        if (!provider) {\n            if (!(options === null || options === void 0 ? void 0 : options.siteKey)) {\n                throw new Error(FirebaseAppCheckWeb.errorSiteKeyMissing);\n            }\n            const { ReCaptchaV3Provider } = await import('firebase/app-check');\n            provider = new ReCaptchaV3Provider(options === null || options === void 0 ? void 0 : options.siteKey);\n        }\n        const app = getApp();\n        this.appCheckInstance = initializeAppCheck(app, {\n            provider,\n            isTokenAutoRefreshEnabled: options === null || options === void 0 ? void 0 : options.isTokenAutoRefreshEnabled,\n        });\n    }\n    async setTokenAutoRefreshEnabled(options) {\n        if (!this.appCheckInstance) {\n            throw new Error(FirebaseAppCheckWeb.errorNotInitialized);\n        }\n        setTokenAutoRefreshEnabled(this.appCheckInstance, options.enabled);\n    }\n    registerOnTokenChangedListener() {\n        if (!this.appCheckInstance) {\n            return;\n        }\n        this.onTokenChangedListenerUnsubscribe = onTokenChanged(this.appCheckInstance, (tokenResult) => this.handleTokenChanged(tokenResult.token));\n    }\n    unregisterOnTokenChangedListener() {\n        if (this.onTokenChangedListenerUnsubscribe) {\n            this.onTokenChangedListenerUnsubscribe();\n        }\n    }\n    handleTokenChanged(token) {\n        const event = {\n            token,\n        };\n        this.notifyListeners(FirebaseAppCheckWeb.tokenChangedEvent, event);\n    }\n}\nFirebaseAppCheckWeb.tokenChangedEvent = 'tokenChanged';\nFirebaseAppCheckWeb.errorNotInitialized = 'AppCheck has not been initialized.';\nFirebaseAppCheckWeb.errorSiteKeyMissing = 'siteKey must be provided.';\n//# sourceMappingURL=web.js.map"],"names":["registerPlugin","WebPlugin","getToken","app","getApp","initializeAppCheck","setTokenAutoRefreshEnabled","onTokenChanged"],"mappings":"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"}