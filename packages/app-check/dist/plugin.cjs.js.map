{"version":3,"file":"plugin.cjs.js","sources":["esm/index.js","esm/web.js"],"sourcesContent":["import { registerPlugin } from '@capacitor/core';\nconst FirebaseAppCheck = registerPlugin('FirebaseAppCheck', {\n    web: () => import('./web').then(m => new m.FirebaseAppCheckWeb()),\n});\nexport * from './definitions';\nexport { FirebaseAppCheck };\n//# sourceMappingURL=index.js.map","import { WebPlugin } from '@capacitor/core';\nimport { getApp } from 'firebase/app';\nimport { getToken, initializeAppCheck, onTokenChanged, setTokenAutoRefreshEnabled, } from 'firebase/app-check';\nexport class FirebaseAppCheckWeb extends WebPlugin {\n    get appCheckInstance() {\n        return this._appCheckInstance;\n    }\n    set appCheckInstance(value) {\n        this._appCheckInstance = value;\n        if (value) {\n            this.registerOnTokenChangedListener();\n        }\n        else {\n            this.unregisterOnTokenChangedListener();\n        }\n    }\n    async getToken(options) {\n        if (!this.appCheckInstance) {\n            throw new Error(FirebaseAppCheckWeb.errorNotInitialized);\n        }\n        const result = await getToken(this.appCheckInstance, options === null || options === void 0 ? void 0 : options.forceRefresh);\n        return {\n            token: result.token,\n        };\n    }\n    async initialize(options) {\n        if (options === null || options === void 0 ? void 0 : options.debugToken) {\n            self.FIREBASE_APPCHECK_DEBUG_TOKEN = options.debugToken;\n        }\n        else if (options === null || options === void 0 ? void 0 : options.debug) {\n            self.FIREBASE_APPCHECK_DEBUG_TOKEN = true;\n        }\n        let provider = options === null || options === void 0 ? void 0 : options.provider;\n        if (!provider) {\n            if (!(options === null || options === void 0 ? void 0 : options.siteKey)) {\n                throw new Error(FirebaseAppCheckWeb.errorSiteKeyMissing);\n            }\n            const { ReCaptchaV3Provider } = await import('firebase/app-check');\n            provider = new ReCaptchaV3Provider(options === null || options === void 0 ? void 0 : options.siteKey);\n        }\n        const app = getApp();\n        this.appCheckInstance = initializeAppCheck(app, {\n            provider,\n            isTokenAutoRefreshEnabled: options === null || options === void 0 ? void 0 : options.isTokenAutoRefreshEnabled,\n        });\n    }\n    async setTokenAutoRefreshEnabled(options) {\n        if (!this.appCheckInstance) {\n            throw new Error(FirebaseAppCheckWeb.errorNotInitialized);\n        }\n        setTokenAutoRefreshEnabled(this.appCheckInstance, options.enabled);\n    }\n    registerOnTokenChangedListener() {\n        if (!this.appCheckInstance) {\n            return;\n        }\n        this.onTokenChangedListenerUnsubscribe = onTokenChanged(this.appCheckInstance, (tokenResult) => this.handleTokenChanged(tokenResult.token));\n    }\n    unregisterOnTokenChangedListener() {\n        if (this.onTokenChangedListenerUnsubscribe) {\n            this.onTokenChangedListenerUnsubscribe();\n        }\n    }\n    handleTokenChanged(token) {\n        const event = {\n            token,\n        };\n        this.notifyListeners(FirebaseAppCheckWeb.tokenChangedEvent, event);\n    }\n}\nFirebaseAppCheckWeb.tokenChangedEvent = 'tokenChanged';\nFirebaseAppCheckWeb.errorNotInitialized = 'AppCheck has not been initialized.';\nFirebaseAppCheckWeb.errorSiteKeyMissing = 'siteKey must be provided.';\n//# sourceMappingURL=web.js.map"],"names":["registerPlugin","WebPlugin","getToken","app","getApp","initializeAppCheck","setTokenAutoRefreshEnabled","onTokenChanged"],"mappings":"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"}